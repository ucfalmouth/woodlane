define(["jquery","underscore"],function(a,b){var c=function(a){var b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return b[a]},d=function(a){var b=new Date,d={},e=a.split("/").reverse();return e[1]=e[1]-1,e=new Date(e[0],e[1],e[2]),d.day=e.getDate(),d.month=c(e.getMonth()),d.year=e.getFullYear(),d.future=b-e<0,d},e=function(a){var b=a.filter(function(a){return a.gsx$date.$t.length&&a.gsx$description.$t.length&&a.gsx$version.$t.length&&a.gsx$title.$t});return b},f=function(a,c){var d='<ul class="release-list">\n';return b.forEach(a,function(a){d+=c(a)}),d+="</ul>"},g=function(c){var g=b.template(c),h=a(".release-notes-link"),i=a(".overlay"),j=h.data("url");h.on("click",function(b){b.preventDefault(),a(".release-list").length||a.ajax({url:j,cache:!1}).done(function(b){var c=b.feed.entry;c=e(c);var h=c.map(function(a){var b={};return b.releaseDate=d(a.gsx$date.$t),b.title=a.gsx$title.$t,b.description=a.gsx$description.$t,b.version=a.gsx$version.$t,b}),i=f(h,g);a(".releases-wrap").html(i)}).fail(function(b,c,d){var e={jqxhr:b,status:c,error:d};a(".loader").remove(),a(".fallback").removeClass("hide").data("error",e)}),i.addClass("open")}),i.on("click",".overlay-close",function(a){a.preventDefault(),i.removeClass("open")})};return{init:g}});