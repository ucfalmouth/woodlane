define(["jquery","underscore"],function(a,b){var c='<li class="release <%if (releaseDate.future) {%>future<%}%>">\n';c+='   <div class="release-content">\n',c+='       <div class="heading">\n',c+='            <h2 class="title">',c+='<span class="version">',c+='<abbr title="Version <%= version %>">v<%= version %></abbr>\n',c+="</span> <%= title %>",c+="</h2>\n",c+="        </div>\n",c+='        <div class="description">\n',c+="            <p><%= description %></p>\n",c+="        </div>\n",c+='        <div class="further-info">\n',c+="            <%if (!releaseDate.future) {%>\n",c+='            <p><i class="icon fa fa-fw fa-check"></i> Version <%= version %> successfully deployed.</p>\n',c+="            <%}%>\n",c+="        </div>\n",c+='        <div class="date">\n',c+='            <div class="date-content">\n',c+='                <h3 class="sr-only">Release date</h3>\n',c+='                <div class="month"><%= releaseDate.month %></div>\n',c+='                <div class="day"><%= releaseDate.day %></div>\n',c+='                <div class="year"><%= releaseDate.year %></div>\n',c+="            </div>\n",c+="        </div>\n",c+="    </div>\n",c+="</li>\n";var d=b.template(c),e=function(a){var b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return b[a]},f=function(a){var b=new Date,c={},d=a.split("/").reverse();return d[1]=d[1]-1,d=new Date(d[0],d[1],d[2]),c.day=d.getDate(),c.month=e(d.getMonth()),c.year=d.getFullYear(),c.future=b-d<0,c},g=function(a){var b=a.filter(function(a){return a.gsx$date.$t.length&&a.gsx$description.$t.length&&a.gsx$version.$t.length&&a.gsx$title.$t});return b},h=function(a){var c='<ul class="release-list">\n';return b.forEach(a,function(a){c+=d(a)}),c+="</ul>"},i=function(){var b=a(".release-notes-link"),c=a(".overlay"),d=b.data("url");b.on("click",function(b){b.preventDefault(),a(".release-list").length||a.ajax({url:d,cache:!1}).done(function(b){var c=b.feed.entry;c=g(c);var d=c.map(function(a){var b={};return b.releaseDate=f(a.gsx$date.$t),b.title=a.gsx$title.$t,b.description=a.gsx$description.$t,b.version=a.gsx$version.$t,b}),e=h(d);a(".releases-wrap").html(e)}).fail(function(b,c,d){var e={jqxhr:b,status:c,error:d};a(".loader").remove(),a(".fallback").removeClass("d-none").data("error",e)}),c.addClass("open")}),c.on("click",".overlay-close a",function(a){a.preventDefault(),c.removeClass("open")})};return{init:i}});